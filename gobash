# vim: set ft=sh:
set -e 
# Takes in a filename of a file _inside_ the dotfiles repo
function transfer() {
    if [ -e "$1" ]; then
        cp ~/.$1 ~/$1.bak
    fi
    cp $1 ~/.$1
    sudo cp /root/.$1 /root/.$1.bak
    sudo cp $1 /root/.$1
}

CURRENT_PERSONAL_COMPUTER='scheherazade'
host="$(hostname)"

echo "Installing new dotfiles, don't forget to increment the version!"
transfer bashrc
transfer bash_personal
transfer bash_aliases

if [ "$host" != "$CURRENT_PERSONAL_COMPUTER" ]; then
    transfer work_customizations
fi

termcount=`ls -logA /dev/pts | wc -l`
termcount=`expr $termcount - 1`
find /dev/pts -print0 | tail -n $termcount -z | xargs -Ixx -0 sh -c 'echo "$(whoami) updated bashrc. Please source to update." > "$1"' -- xx
